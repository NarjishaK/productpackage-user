(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{776:(e,a,r)=>{"use strict";r.d(a,{default:()=>c});var t=r(5155),s=r(2115);let l=e=>{let{selectedPayment:a,onPaymentChange:r}=e;return(0,t.jsxs)("div",{className:"bg-white shadow-1 rounded-[10px] mt-7.5",children:[(0,t.jsx)("div",{className:"border-b border-gray-3 py-5 px-4 sm:px-8.5",children:(0,t.jsx)("h3",{className:"font-medium text-xl text-dark",children:"Payment Method"})}),(0,t.jsx)("div",{className:"p-4 sm:p-8.5",children:(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsxs)("label",{htmlFor:"COD",className:"flex cursor-pointer select-none items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"radio",name:"paymentMethod",id:"COD",value:"COD",checked:"COD"===a,onChange:e=>r(e.target.value),className:"sr-only"}),(0,t.jsx)("div",{className:"flex h-4 w-4 items-center justify-center rounded-full ".concat("COD"===a?"border-4 border-blue":"border border-gray-4")})]}),(0,t.jsx)("div",{className:"rounded-md border-[0.5px] py-3.5 px-5 ease-out duration-200 hover:bg-gray-2 hover:border-transparent hover:shadow-none min-w-[240px] ".concat("COD"===a?"border-transparent bg-gray-2":" border-gray-4 shadow-1"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"pr-2.5",children:(0,t.jsxs)("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",children:[(0,t.jsx)("circle",{cx:"10.5",cy:"10.5",r:"10.5",fill:"#10B981"}),(0,t.jsx)("path",{d:"M6 10.5L9 13.5L15 7.5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,t.jsx)("div",{className:"border-l border-gray-4 pl-2.5",children:(0,t.jsx)("p",{children:"Cash on delivery"})})]})})]})})})]})},n=e=>{let{onBillingChange:a,billingData:r}=e,s=e=>{let{name:t,value:s}=e.target;a({...r,[t]:s})};return(0,t.jsxs)("div",{className:"mt-9",children:[(0,t.jsx)("h2",{className:"font-medium text-dark text-xl sm:text-2xl mb-5.5",children:"Billing details"}),(0,t.jsxs)("div",{className:"bg-white shadow-1 rounded-[10px] p-4 sm:p-8.5",children:[(0,t.jsx)("div",{className:"flex flex-col lg:flex-row gap-5 sm:gap-8 mb-5",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("label",{htmlFor:"firstName",className:"block mb-2.5",children:["First Name ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"firstName",id:"firstName",value:r.firstName||"",onChange:s,placeholder:"John",required:!0,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]})}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("label",{htmlFor:"country",className:"block mb-2.5",children:["Country/ Region ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("select",{name:"country",value:r.country||"",onChange:s,required:!0,className:"w-full bg-gray-1 rounded-md border border-gray-3 text-dark-4 py-3 pl-5 pr-9 duration-200 appearance-none outline-none focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20",children:[(0,t.jsx)("option",{value:"",children:"Select Country"}),(0,t.jsx)("option",{value:"India",children:"India"})]})})]}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("label",{htmlFor:"address",className:"block mb-2.5",children:["Street Address ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"address",id:"address",value:r.address||"",onChange:s,placeholder:"House number and street name",required:!0,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"}),(0,t.jsx)("div",{className:"mt-5",children:(0,t.jsx)("input",{type:"text",name:"address1",id:"address1",value:r.address1||"",onChange:s,placeholder:"Apartment, suite, unit, etc. (optional)",className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})})]}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("label",{htmlFor:"city",className:"block mb-2.5",children:["Town/ City ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"city",id:"city",value:r.city||"",onChange:s,required:!0,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]}),(0,t.jsxs)("div",{className:"flex gap-5 mb-5",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{htmlFor:"state",className:"block mb-2.5",children:"State"}),(0,t.jsx)("input",{type:"text",name:"state",id:"state",value:r.state||"",onChange:s,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]}),(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{htmlFor:"pincode",className:"block mb-2.5",children:"Pincode"}),(0,t.jsx)("input",{type:"text",name:"pincode",id:"pincode",value:r.pincode||"",onChange:s,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]})]}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("label",{htmlFor:"phone",className:"block mb-2.5",children:["Phone ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("input",{type:"tel",name:"phone",id:"phone",value:r.phone||"",onChange:s,required:!0,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]}),(0,t.jsxs)("div",{className:"mb-5.5",children:[(0,t.jsxs)("label",{htmlFor:"email",className:"block mb-2.5",children:["Email Address ",(0,t.jsx)("span",{className:"text-red",children:"*"})]}),(0,t.jsx)("input",{type:"email",name:"email",id:"email",value:r.email||"",onChange:s,required:!0,className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]})]})]})};var d=r(4514),o=r(4752),i=r.n(o);let c=()=>{let[e,a]=(0,s.useState)([]),[r,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(0),p=()=>{try{let e=localStorage.getItem("customerDetails");if(!e)return console.log("No customer details in localStorage"),null;return JSON.parse(e)}catch(e){return console.error("Error parsing customer details:",e),null}};(0,s.useEffect)(()=>{let e=p(),r=(null==e?void 0:e._id)||(null==e?void 0:e.id);r?(o(!0),(0,d.L8)(r).then(e=>{a(e),x(e.reduce((e,a)=>{var r;return e+(null==a?void 0:null===(r=a.packageId)||void 0===r?void 0:r.price)*a.quantity},0))}).catch(e=>{console.error("Failed to fetch customer cart",e)}).finally(()=>{u(!1)})):(o(!1),u(!1))},[]);let[h,g]=(0,s.useState)(!1),[b,y]=(0,s.useState)({firstName:"",country:"",address:"",address1:"",city:"",state:"",pincode:"",phone:"",email:""}),[f,j]=(0,s.useState)("COD"),[v,N]=(0,s.useState)(""),[w,k]=(0,s.useState)(""),C=r?m:0,S=C+0,O=async e=>{try{console.log("Sending order data:",e);let a=await fetch("".concat(d.C1,"/customerorder/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await a.json();if(!a.ok)throw Error(r.message||"HTTP error! status: ".concat(a.status));return r}catch(e){throw console.error("API call error:",e),e}},F=()=>{let a=["firstName","country","address","city","phone","email"].filter(e=>{var a;return!(null===(a=b[e])||void 0===a?void 0:a.trim())});return a.length>0?(i().fire({icon:"error",title:"Oops...",text:"Please fill in required fields: ".concat(a.join(", "))}),!1):0!==e.length||(i().fire({icon:"error",title:"Oops...",text:"Your cart is empty"}),!1)},D=async a=>{if(a.preventDefault(),F()){g(!0);try{var t,s,l;let a=p(),n=(null==a?void 0:a._id)||(null==a?void 0:a.id);if(!n){i().fire({icon:"error",title:"Oops...",text:"Customer not found. Please log in again."}),g(!1);return}console.log("Using customer ID for order:",n);let d=e.map(e=>{var a;return r?{packageId:(null===(a=e.packageId)||void 0===a?void 0:a._id)||e.packageId,quantity:e.quantity}:{_id:e.id,packagename:e.packagename,price:e.price,image:e.image,mainCategory:e.mainCategory,quantity:e.quantity}}),o={customerId:n,billingDetails:{firstName:b.firstName.trim(),country:b.country.trim(),address:b.address.trim(),address1:(null===(t=b.address1)||void 0===t?void 0:t.trim())||"",city:b.city.trim(),state:(null===(s=b.state)||void 0===s?void 0:s.trim())||"",pincode:(null===(l=b.pincode)||void 0===l?void 0:l.trim())||"",phone:b.phone.trim(),email:b.email.trim()},paymentMethod:f,cartItems:d,totalAmount:S,note:v.trim(),deliveryDate:w||null};console.log("Creating order with data:",o);let c=await O(o);console.log("Order created successfully:",c),i().fire({icon:"success",title:"Success!",text:"Order created successfully!"}),setTimeout(()=>{window.location.href="/"},3e3)}catch(e){console.error("Error creating order:",e),i().fire({icon:"error",title:"Oops...",text:"Failed to create order: ".concat(e.message)})}finally{g(!1)}}};return(0,t.jsx)("div",{className:"bg-gray-50 min-h-screen py-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"Checkout"}),(0,t.jsx)("form",{onSubmit:D,children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,t.jsxs)("div",{className:"lg:w-2/3",children:[(0,t.jsx)(n,{onBillingChange:y,billingData:b}),(0,t.jsx)("div",{className:"bg-white shadow-1 rounded-[10px] p-4 sm:p-8.5 mt-7.5",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"deliveryDate",className:"block mb-2.5",children:"Preferred Delivery Date (optional)"}),(0,t.jsx)("input",{type:"date",name:"deliveryDate",id:"deliveryDate",value:w,onChange:e=>k(e.target.value),min:new Date().toISOString().split("T")[0],className:"rounded-md border border-gray-3 bg-gray-1 w-full py-2.5 px-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]})}),(0,t.jsx)("div",{className:"bg-white shadow-1 rounded-[10px] p-4 sm:p-8.5 mt-7.5",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"notes",className:"block mb-2.5",children:"Other Notes (optional)"}),(0,t.jsx)("textarea",{name:"notes",id:"notes",rows:5,value:v,onChange:e=>N(e.target.value),placeholder:"Notes about your order, e.g. special notes for delivery.",className:"rounded-md border border-gray-3 bg-gray-1 placeholder:text-dark-5 w-full p-5 outline-none duration-200 focus:border-transparent focus:shadow-input focus:ring-2 focus:ring-blue/20"})]})})]}),(0,t.jsxs)("div",{className:"max-w-[455px] w-full",children:[(0,t.jsxs)("div",{className:"bg-white shadow-1 rounded-[10px]",children:[(0,t.jsx)("div",{className:"border-b border-gray-3 py-5 px-4 sm:px-8.5",children:(0,t.jsx)("h3",{className:"font-medium text-xl text-dark",children:"Your Order"})}),(0,t.jsxs)("div",{className:"pt-2.5 pb-8.5 px-4 sm:px-8.5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between py-5 border-b border-gray-3",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h4",{className:"font-medium text-dark",children:"Product"})}),(0,t.jsx)("div",{children:(0,t.jsx)("h4",{className:"font-medium text-dark text-right",children:"Subtotal"})})]}),c?(0,t.jsx)("div",{className:"flex items-center justify-center py-5",children:(0,t.jsx)("p",{className:"text-dark",children:"Loading order details..."})}):e.length>0?e.map((e,a)=>{var s,l;return(0,t.jsxs)("div",{className:"flex items-center justify-between py-5 border-b border-gray-3",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-dark",children:[r?null==e?void 0:null===(s=e.packageId)||void 0===s?void 0:s.packagename:e.packagename," x ".concat(e.quantity)]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-dark text-right",children:["₹",r?((null===(l=e.packageId)||void 0===l?void 0:l.price)*e.quantity).toFixed(2):(e.price*e.quantity).toFixed(2)]})})]},a)}):(0,t.jsx)("div",{className:"flex items-center justify-center py-5",children:(0,t.jsx)("p",{className:"text-dark",children:"No items in cart"})}),e.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between py-5 border-b border-gray-3",children:[(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"text-dark",children:"Subtotal"})}),(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-dark text-right",children:["₹",C.toFixed(2)]})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-5 border-b border-gray-3",children:[(0,t.jsx)("p",{className:"text-dark",children:"Shipping Fee"}),(0,t.jsxs)("p",{className:"text-dark",children:["₹","0.00"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-5",children:[(0,t.jsx)("p",{className:"font-medium text-lg text-dark",children:"Total"}),(0,t.jsxs)("p",{className:"font-medium text-lg text-dark",children:["₹",S.toFixed(2)]})]})]})]}),(0,t.jsx)(l,{selectedPayment:f,onPaymentChange:j}),(0,t.jsx)("button",{type:"submit",disabled:h||0===e.length,className:"w-full flex justify-center font-medium text-white bg-blue py-3 px-6 rounded-md ease-out duration-200 hover:bg-blue-dark mt-7.5 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing Order..."]}):0===e.length?"Cart is Empty":"Place Order"})]})]})})]})})}},4514:(e,a,r)=>{"use strict";r.d(a,{C1:()=>s,Fe:()=>n,Gb:()=>l,L8:()=>o,Sh:()=>i,Ws:()=>x,bX:()=>d,gI:()=>u,j0:()=>p,j_:()=>h,s2:()=>m,z5:()=>c});var t=r(3464);let s="https://api.sstappstore.in",l=async e=>(await t.A.get("".concat(s,"/customerorder/").concat(e))).data,n=async e=>{try{return(await t.A.get("".concat(s,"/subcategory/package/").concat(e))).data}catch(e){throw console.error("Error fetching package with products:",e),e}},d=async e=>(await t.A.get("".concat(s,"/subcategory/").concat(e))).data,o=async e=>(await t.A.get("".concat(s,"/customercart/").concat(e))).data,i=async e=>(await t.A.post("".concat(s,"/customer/login"),e)).data,c=async e=>(await t.A.post("".concat(s,"/customer"),e)).data,u=async()=>(await t.A.get("".concat(s,"/subcategory"))).data,m=async()=>(await t.A.get("".concat(s,"/banner"))).data,x=async()=>(await t.A.get("".concat(s,"/logo"))).data,p=async()=>(await t.A.get("".concat(s,"/product"))).data,h=async()=>(await t.A.get("".concat(s,"/subcategory/allpackage"))).data},8236:(e,a,r)=>{Promise.resolve().then(r.bind(r,776))}},e=>{var a=a=>e(e.s=a);e.O(0,[320,464,441,684,358],()=>a(8236)),_N_E=e.O()}]);